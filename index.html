<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fazenda VR - Ajuste de Escalas</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
</head>
<body>

    <a-scene>
        <a-assets>
            <a-asset-item id="vaca-glb" src="vaca.glb"></a-asset-item>
            <a-asset-item id="galinha-glb" src="galinha.glb"></a-asset-item>
            <a-asset-item id="porco-glb" src="porco.glb"></a-asset-item>
        </a-assets>

        <a-sky color="#87CEEB"></a-sky>
        
        <a-plane id="chao" 
                 position="0 0 0" 
                 rotation="-90 0 0" 
                 width="100" height="100" 
                 color="#7CFC00" 
                 class="movimento">
        </a-plane>

        <a-entity id="vaca-animal"
                  gltf-model="#vaca-glb" 
                  position="-4 0 -7" 
                  scale="0.2 0.2 0.2"
                  class="interativel"
                  animation__click="property: position; to: -4 0.5 -7; dur: 300; dir: alternate; loop: 2; startEvents: click">
        </a-entity>

        <a-entity id="galinha-animal"
                  gltf-model="#galinha-glb" 
                  position="0 0 -4" 
                  scale="0.005 0.005 0.005"
                  class="interativel"
                  animation__click="property: scale; to: 0.006 0.006 0.006; dur: 200; dir: alternate; loop: 2; startEvents: click">
        </a-entity>

        <a-entity id="porco-animal"
                  gltf-model="#porco-glb" 
                  position="4 0 -6" 
                  scale="0.05 0.05 0.05"
                  class="interativel"
                  animation__click="property: rotation; to: 0 360 0; dur: 1000; startEvents: click">
        </a-entity>

        <a-light type="ambient" color="#FFF" intensity="0.8"></a-light>
        <a-light type="directional" color="#FFF" intensity="0.6" position="-1 2 1"></a-light>

        <a-entity id="rig" position="0 0 0">
            <a-entity camera look-controls position="0 1.6 0">
                
                <a-entity cursor="fuse: true; fuseTimeout: 1200"
                          position="0 0 -1"
                          geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                          material="color: white; shader: flat"
                          raycaster="objects: .interativel, .movimento; far: 5">
                    
                    <a-animation begin="fusing" easing="ease-in" attribute="scale" from="1 1 1" to="0.1 0.1 0.1" dur="1200"></a-animation>
                    <a-animation begin="mouseleave" easing="ease-in" attribute="scale" from="0.1 0.1 0.1" to="1 1 1" dur="100"></a-animation>
                </a-entity>

            </a-entity>
        </a-entity>

    </a-scene>

    <script>
        const player = document.querySelector('#rig');

        // Sistema para andar olhando para o chÃ£o
        document.querySelector('#chao').addEventListener('click', function (evt) {
            let ponto = evt.detail.intersection.point;
            player.setAttribute('animation', {
                property: 'position',
                to: `${ponto.x} 0 ${ponto.z}`,
                dur: 1500,
                easing: 'easeInOutQuad'
            });
        });

        // Clique nos animais
        document.querySelectorAll('.interativel').forEach(animal => {
            animal.addEventListener('click', function () {
                console.log("Interagindo com " + this.id);
            });
        });
    </script>

</body>
</html>
